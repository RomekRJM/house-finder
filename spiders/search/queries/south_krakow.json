{
  "query": {
    "bool": {
      "must": [
        {
          "function_score": {
            "query": {
              "match_all": {}
            },
            "functions": [
              {
                "script_score": {
                  "script": "(Math.pow(doc['year_built'].value,2)+Math.pow(doc['num_rooms'].value,5)+Math.pow(doc['size'].value,3) ) / (Math.pow(doc['floor'].value,2))/Math.pow(doc['price_per_sqm'].value,1)"
                }
              }
            ],
            "score_mode": "avg",
            "boost_mode": "sum"
          }
        },
        {
          "match": {
            "ownership": "pełna własność"
          }
        },
        {
          "range": {
            "size": {
              "gte": 45
            }
          }
        },
        {
          "range": {
            "price": {
              "lte": 450000
            }
          }
        },
        {
          "range": {
            "num_rooms": {
              "gte": 3
            }
          }
        },
        {
          "range": {
            "floor": {
              "gte": 1,
              "lte": 4
            }
          }
        }
      ],
      "must_not": [
        {
          "exists": {
            "field": "notified_on"
          }
        }
      ],
      "filter": [
        {
          "geo_polygon": {
            "location": {
              "points": [
   [
              19.92495059967041,
              50.05275770417911
            ],
            [
              19.927611351013184,
              50.04914784131923
            ],
            [
              19.918599128723145,
              50.04619912590478
            ],
            [
              19.92091655731201,
              50.042395842267645
            ],
            [
              19.92048740386963,
              50.03817880597379
            ],
            [
              19.917783737182617,
              50.03622175480144
            ],
            [
              19.913020133972168,
              50.03219714537746
            ],
            [
              19.898428916931152,
              50.025249765662544
            ],
            [
              19.894824028015137,
              50.0213896760175
            ],
            [
              19.8867130279541,
              50.01965253447933
            ],
            [
              19.88525390625,
              50.01692261372465
            ],
            [
              19.888472557067868,
              50.016426247831525
            ],
            [
              19.89572525024414,
              50.016702007294086
            ],
            [
              19.90113258361816,
              50.018604704451356
            ],
            [
              19.90688323974609,
              50.02326461544344
            ],
            [
              19.91224765777588,
              50.02558061605634
            ],
            [
              19.918727874755856,
              50.02814462934094
            ],
            [
              19.924306869506836,
              50.0266558640978
            ],
            [
              19.926066398620605,
              50.02957821151643
            ],
            [
              19.92821216583252,
              50.02949550601562
            ],
            [
              19.9271821975708,
              50.02555304527722
            ],
            [
              19.92868423461914,
              50.02351276370737
            ],
            [
              19.931044578552246,
              50.02218929148684
            ],
            [
              19.92495059967041,
              50.01604018192511
            ],
            [
              19.924349784851074,
              50.01223450914533
            ],
            [
              19.927611351013184,
              50.010800409334486
            ],
            [
              19.931302070617672,
              50.01027640065146
            ],
            [
              19.93366241455078,
              50.01328247809721
            ],
            [
              19.93473529815674,
              50.01783260454423
            ],
            [
              19.935851097106934,
              50.02296132138001
            ],
            [
              19.938855171203613,
              50.02806192137138
            ],
            [
              19.94520664215088,
              50.03503645967209
            ],
            [
              19.94387626647949,
              50.03798586081131
            ],
            [
              19.9471378326416,
              50.04008065251326
            ],
            [
              19.957051277160645,
              50.04280925726029
            ],
            [
              19.96494770050049,
              50.034071662966376
            ],
            [
              19.976449012756348,
              50.02370576702642
            ],
            [
              19.973144531249996,
              50.01772230354462
            ],
            [
              19.959712028503418,
              50.014606195686085
            ],
            [
              19.948511123657227,
              50.015323194154924
            ],
            [
              19.94615077972412,
              50.012648183830116
            ],
            [
              19.94881153106689,
              50.01171051609923
            ],
            [
              19.959068298339844,
              50.010579774795914
            ],
            [
              19.97387409210205,
              50.01383403152402
            ],
            [
              19.980998039245605,
              50.016977765174026
            ],
            [
              19.98438835144043,
              50.017170794748324
            ],
            [
              19.988036155700684,
              50.014771657820795
            ],
            [
              19.99112606048584,
              50.01604018192511
            ],
            [
              19.992928504943848,
              50.013916763992015
            ],
            [
              19.99936580657959,
              50.011848409560024
            ],
            [
              20.004730224609375,
              50.01413738321032
            ],
            [
              20.008764266967773,
              50.0152680408064
            ],
            [
              20.01138210296631,
              50.01482681173907
            ],
            [
              20.011253356933594,
              50.01805320578377
            ],
            [
              20.003442764282227,
              50.017887754949086
            ],
            [
              19.998764991760254,
              50.016315943603374
            ],
            [
              19.98790740966797,
              50.021334529632455
            ],
            [
              19.980826377868652,
              50.02638016176645
            ],
            [
              19.975504875183105,
              50.031893907715165
            ],
            [
              19.973788261413574,
              50.03828906000424
            ],
            [
              19.98262882232666,
              50.0376275320238
            ],
            [
              20.00288486480713,
              50.03633201332595
            ],
            [
              20.00563144683838,
              50.04184461673913
            ],
            [
              19.994473457336426,
              50.0440770410371
            ],
            [
              19.98241424560547,
              50.044821159398865
            ],
            [
              19.971728324890137,
              50.051407481920556
            ],
            [
              19.966964721679688,
              50.05295058997193
            ],
            [
              19.95739459991455,
              50.05176570785496
            ],
            [
              19.948253631591797,
              50.046805418635245
            ],
            [
              19.94147300720215,
              50.044986517468246
            ],
            [
              19.936494827270508,
              50.04666762550536
            ],
            [
              19.9326753616333,
              50.052675038602
            ],
            [
              19.93018627166748,
              50.054521202567116
            ],
            [
              19.92495059967041,
              50.05275770417911
            ]
              ]
            }
          }
        }
      ]
    }
  }
}