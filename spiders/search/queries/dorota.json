{
  "query": {
    "bool": {
      "must": [
        {
          "function_score": {
            "query": {
              "match_all": {}
            },
            "functions": [
              {
                "script_score": {
                  "script": "(Math.pow(doc['year_built'].value,2)+Math.pow(doc['num_rooms'].value,5)+Math.pow(doc['size'].value,3)) / doc['price_per_sqm'].value"
                }
              }
            ],
            "score_mode": "avg",
            "boost_mode": "sum"
          }
        },
        {
          "match": {
            "ownership": "pełna własność"
          }
        },
        {
          "range": {
            "size": {
              "gte": 27
            }
          }
        },
        {
          "range": {
            "price": {
              "lte": 320000
            }
          }
        },
        {
          "range": {
            "year_built": {
              "gte": 1970,
              "lte": 2019
            }
          }
        },
        {
          "range": {
            "num_rooms": {
              "gte": 1
            }
          }
        },
        {
          "range": {
            "floor": {
              "gte": 0,
              "lte": 15
            }
          }
        }
      ],
      "filter": [
        {
          "geo_polygon": {
            "location": {
              "points": [
                [
                  19.95220184326172,
                  50.08732698109428
                ],
                [
                  19.927825927734375,
                  50.09481600110869
                ],
                [
                  19.90276336669922,
                  50.08886893382965
                ],
                [
                  19.883537292480465,
                  50.065954814811846
                ],
                [
                  19.865684509277344,
                  50.03023985039574
                ],
                [
                  19.866714477539062,
                  50.01126925436572
                ],
                [
                  19.90550994873047,
                  50.0013397941817
                ],
                [
                  19.94464874267578,
                  50.00398785079543
                ],
                [
                  19.995803833007812,
                  50.004208515595614
                ],
                [
                  20.03185272216797,
                  50.00773901463687
                ],
                [
                  20.059661865234375,
                  50.01369614376082
                ],
                [
                  20.06275177001953,
                  50.03729676461553
                ],
                [
                  20.071678161621094,
                  50.05603665721485
                ],
                [
                  20.068588256835938,
                  50.06661595241162
                ],
                [
                  20.051078796386715,
                  50.082921128490376
                ],
                [
                  20.02635955810547,
                  50.10252406395657
                ],
                [
                  20.007476806640625,
                  50.1075886871639
                ],
                [
                  19.986190795898438,
                  50.10252406395657
                ],
                [
                  19.95220184326172,
                  50.08732698109428
                ]
              ]
            }
          }
        }
      ]
    }
  },
  "size": 60
}
